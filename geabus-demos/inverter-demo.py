import os
import serial
import time

fd = serial.Serial('/dev/ttyUSB0', 230400, serial.EIGHTBITS, serial.PARITY_NONE, serial.STOPBITS_ONE)

motorInit = serial.to_bytes([0xE2,0x3F,0x70,0xC0,0xB8,0x04,0xF0,0x20,0x58,0x02,0x3D,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0x23,0x01,0x02,0xF0,0x26,0x01,0x1F,0xF2,0x13,0x01,0x00,0x7A,0x73,0xE3])
motor1kRpm = serial.to_bytes([0xE2,0x3F,0x70,0xC0,0xB8,0x04,0xF0,0x20,0x58,0x04,0x3E,0xFF,0xFF,0x01,0x00,0xFB,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0x23,0x01,0x02,0xF0,0x26,0x01,0x39,0xF2,0x13,0x01,0x00,0x95,0xC8,0xE3])
motor16kRpm = serial.to_bytes([0xE2,0x3F,0x70,0xC0,0xB8,0x04,0xF0,0x20,0x58,0x05,0x3F,0xFF,0xFF,0xFC,0x01,0xC1,0x97,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0x23,0x01,0x02,0xF0,0x26,0x01,0x01,0xF2,0x13,0x01,0x00,0x5B,0x1D,0xE3])

ddAgitate = serial.to_bytes([0xE2,0x3F,0x70,0xC0,0xB8,0x04,0xF0,0x20,0x58,0x03,0x62,0xFF,0xFF,0x02,0xFF,0xFF,0xFF,0x08,0x24,0xFD,0x2E,0x05,0x5A,0x03,0x20,0x08,0x24,0x02,0xD1,0x05,0x5A,0x03,0x20,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0x23,0x01,0x02,0xF0,0x26,0x01,0x02,0xF2,0x13,0x01,0x00,0x18,0x63,0xE3])
ddAgitateEx = serial.to_bytes([0xE2,0x3F,0x70,0xC0,0xB8,0x04,0xF0,0x20,0x58,0x03,0x62,0xFF,0xFF,0x02,0xFF,0xFF,0xFF,0x08,0x24,0xFD,0x2E,0x40,0x00,0x03,0x20,0x08,0x24,0x02,0xD1,0x40,0x00,0x03,0x20,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0x23,0x01,0x02,0xF0,0x26,0x01,0x02,0xF2,0x13,0x01,0x00,0xBA,0xD5,0xE3])
ddSpin = serial.to_bytes([0xE2,0x3F,0x70,0xC0,0xB8,0x04,0xF0,0x20,0x58,0x04,0x33,0xFF,0xFF,0x00,0x0A,0xFB,0xE0,0xE0,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xF0,0x23,0x01,0x02,0xF0,0x26,0x01,0x02,0xF2,0x13,0x01,0x00,0x70,0x29,0xE3])

while True:
	fd.write(motorInit)
	fd.write(ddAgitateEx)
	time.sleep(29) # The inverter must receive a command within 30 seconds to continue running the motor
	fd.write(motorInit)
	fd.write(ddAgitateEx)
	time.sleep(29)
